identity: tutorial
metadata:
  status: under development
  createdBy: Bob
  approvedBy: Alice
policy:
  mainPolicyId: http://axiomatics.com/alfa/identifier/tutorial.main
  xacmlSpecifications:
  - <?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA
    Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification
    to this file will be lost upon recompilation of the source ALFA file--><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-unless-deny"
    PolicySetId="http://axiomatics.com/alfa/identifier/demo.tutorial" Version="1.0"
    xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><xacml3:Description>Tutorial</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable"
    PolicySetId="http://axiomatics.com/alfa/identifier/demo.tutorial.records" Version="1.0"><xacml3:Description>Records</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/demo.tutorial.records.viewRecord"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">view</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="demo.tutorial.records.viewRecord.managersCanViewRecords"><xacml3:Description/><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">manager</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Rule></xacml3:Policy><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/demo.tutorial.records.editRecord"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">edit</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Policy><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/demo.tutorial.records.publishRecord"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">publish</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Policy></xacml3:PolicySet></xacml3:PolicySet>
  - <?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA
    Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification
    to this file will be lost upon recompilation of the source ALFA file--><xacml3:Policy
    xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="http://axiomatics.com/alfa/identifier/example.demoObligation"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target/><xacml3:Rule
    Effect="Permit" RuleId="example.demoObligation.allow"><xacml3:Description/><xacml3:Target/></xacml3:Rule><xacml3:ObligationExpressions><xacml3:ObligationExpression
    FulfillOn="Permit" ObligationId="example.someObl"><xacml3:AttributeAssignmentExpression
    AttributeId="structuredData" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">Mark</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression><xacml3:AttributeAssignmentExpression
    AttributeId="userRole" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"><xacml3:AttributeDesignator
    AttributeId="userRole" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:AttributeAssignmentExpression><xacml3:AttributeAssignmentExpression
    AttributeId="item.licenseID" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"><xacml3:AttributeDesignator
    AttributeId="item.licenseID" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:AttributeAssignmentExpression></xacml3:ObligationExpression></xacml3:ObligationExpressions></xacml3:Policy>
  - <?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA
    Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification
    to this file will be lost upon recompilation of the source ALFA file--><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable"
    PolicySetId="http://axiomatics.com/alfa/identifier/medical.medicalRecords" Version="1.0"
    xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><xacml3:Description/><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/medical.medicalRecords.nurses"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">nurse</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="userRole" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="medical.medicalRecords.nurses.allowSameDepartment"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="userDepartment" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator
    AttributeId="recordDepartment" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/medical.medicalRecords.doctors"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">doctor</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="userRole" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="medical.medicalRecords.doctors.allowAssignedPatients"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of"><xacml3:AttributeDesignator
    AttributeId="patientId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator
    AttributeId="assignedPatients" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/medical.medicalRecords.patients"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">patient</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="userRole" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="medical.medicalRecords.patients.allowOwnRecord"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="userId" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator
    AttributeId="patientId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy></xacml3:PolicySet>
  - <?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA
    Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification
    to this file will be lost upon recompilation of the source ALFA file--><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-overrides"
    PolicySetId="http://axiomatics.com/alfa/identifier/tutorial.main" Version="1.0"
    xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><xacml3:Description>The
    Main Policyset</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-unless-deny"
    PolicySetId="http://axiomatics.com/alfa/identifier/tutorial.main.tutorialRecords"
    Version="1.0"><xacml3:Description>Master APS Tutorial Records policy</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">record</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="object.objectType" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:PolicySetIdReference>http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords</xacml3:PolicySetIdReference></xacml3:PolicySet></xacml3:PolicySet>
  - |-
    <?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification to this file will be lost upon recompilation of the source ALFA file--><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit" PolicySetId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords" Version="1.0" xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><xacml3:Description>APS Tutorial Records policy</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">record</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="object.objectType" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords.globalDenyChecks" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides" Version="1.0"><xacml3:Description>Global Deny Checks</xacml3:Description><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target/><xacml3:Rule Effect="Deny" RuleId="tutorial.records.mainRecords.globalDenyChecks/tutorial.records.denyIfTheUserDoesNotHaveARole"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-equal"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag-size"><xacml3:AttributeDesignator AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">0</xacml3:AttributeValue></xacml3:Apply></xacml3:Condition><xacml3:AdviceExpressions><xacml3:AdviceExpression AdviceId="tutorial.denyMessage" AppliesTo="Deny"><xacml3:AttributeAssignmentExpression AttributeId="message.denyReason" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:2.0:function:string-concatenate"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:2.0:function:string-concatenate"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">I'm sorry </xacml3:AttributeValue><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only"><xacml3:AttributeDesignator AttributeId="user.employeeId" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Apply><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"> I'm afraid you can't do that because you do not have a role</xacml3:AttributeValue></xacml3:Apply></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule></xacml3:Policy><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable" PolicySetId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords.viewRecords" Version="1.0"><xacml3:Description>View Records</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">view</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="action.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords.viewRecords.managersViewRecords" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="1.0"><xacml3:Description>Policies for Managers viewing records</xacml3:Description><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">manager</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect="Permit" RuleId="tutorial.records.mainRecords.viewRecords.managersViewRecords.managersCanView"><xacml3:Description>R1 - A manager can view any record</xacml3:Description><xacml3:Target/></xacml3:Rule></xacml3:Policy><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords.viewRecords.employeesViewRecords" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">employee</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect="Permit" RuleId="tutorial.records.mainRecords.viewRecords.employeesViewRecords.employeeCanViewIfSameDepartment"><xacml3:Description>R2 - An employee can view a record in their own department</xacml3:Description><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="user.department" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="record.department" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule><xacml3:Rule Effect="Permit" RuleId="tutorial.records.mainRecords.viewRecords.employeesViewRecords/tutorial.library.usersInSameDeptArePermitted"><xacml3:Description>Permit if a record is in their own department</xacml3:Description><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="user.department" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="record.department" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule><xacml3:Rule Effect="Permit" RuleId="tutorial.records.mainRecords.viewRecords.employeesViewRecords/tutorial.library.ownerOfTheRecordIsPermitted"><xacml3:Description>Permit the owner of a record</xacml3:Description><xacml3:Target/><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="record.owner" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="user.employeeId" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule><xacml3:Rule Effect="Deny" RuleId="tutorial.records.mainRecords.viewRecords.employeesViewRecords.elseDeny"><xacml3:Description>Deny Catch all (else Deny)</xacml3:Description><xacml3:Target/></xacml3:Rule></xacml3:Policy></xacml3:PolicySet><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable" PolicySetId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords.editRecords" Version="1.0"><xacml3:Description>Edit Records</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">edit</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="action.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords.editRecords.employeeEditRecord" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="1.0"><xacml3:Description>Policies for employees editing records</xacml3:Description><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">employee</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect="Permit" RuleId="tutorial.records.mainRecords.editRecords.employeeEditRecord.employeeCanEdit"><xacml3:Description>R3 - An employee can edit a record they own, if it is in draft mode</xacml3:Description><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">draft</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="record.status" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="user.employeeId" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="record.owner" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule><xacml3:Rule Effect="Deny" RuleId="tutorial.records.mainRecords.editRecords.employeeEditRecord.elseDeny"><xacml3:Description>Deny Catch all (else Deny)</xacml3:Description><xacml3:Target/></xacml3:Rule></xacml3:Policy></xacml3:PolicySet><xacml3:PolicySet PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable" PolicySetId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords.publishRecords" Version="1.0"><xacml3:Description>Publish Records</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">publish</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="action.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Policy PolicyId="http://axiomatics.com/alfa/identifier/tutorial.records.mainRecords.publishRecords.managersViewRecords" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="1.0"><xacml3:Description>Policies for Managers viewing records</xacml3:Description><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">manager</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect="Permit" RuleId="tutorial.records.mainRecords.publishRecords.managersViewRecords.managerCanPublish"><xacml3:Description>R4 - A manager can publish a record if the record is in final mode
    and it belongs to a employee below that manager.</xacml3:Description><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">final</xacml3:AttributeValue><xacml3:AttributeDesignator AttributeId="record.status" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Condition><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator AttributeId="record.owner" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator AttributeId="user.subordinate" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule><xacml3:Rule Effect="Deny" RuleId="tutorial.records.mainRecords.publishRecords.managersViewRecords.elseDeny"><xacml3:Description>Deny Catch all (else Deny)</xacml3:Description><xacml3:Target/></xacml3:Rule></xacml3:Policy></xacml3:PolicySet></xacml3:PolicySet>
attributes:
  action.actionId:
    xacmlId: action.actionId
    category: Action
    datatype: string
  object.objectType:
    xacmlId: object.objectType
    category: Resource
    datatype: string
  record.department:
    xacmlId: record.department
    category: Resource
    datatype: string
  record.recordId:
    xacmlId: record.recordId
    category: Resource
    datatype: string
  record.owner:
    xacmlId: record.owner
    category: Resource
    datatype: string
  record.status:
    xacmlId: record.status
    category: Resource
    datatype: string
  user.employeeId:
    xacmlId: user.employeeId
    category: AccessSubject
    datatype: string
  user.subordinate:
    xacmlId: user.subordinate
    category: AccessSubject
    datatype: string
  user.role:
    xacmlId: user.role
    category: AccessSubject
    datatype: string
  user.department:
    xacmlId: user.department
    category: AccessSubject
    datatype: string
attributeConnectors:
  allDataDB:
    className: com.axiomatics.acs.plugin.pips.table.TablePipModule
    provides:
    - record.department
    - record.owner
    - record.status
    - user.subordinate
    - user.role
    - user.department
    configurationString: |
      <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
      <configuration xmlns="http://www.axiomatics.com/table.config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="">
          <connnection>
              <url>jdbc:h2:mem:tutorial;INIT=RUNSCRIPT FROM '../data/allData.sql';user=axiomatics;password=Attributes</url>
              <driver>org.h2.Driver</driver>
          </connnection>
          <mapping isSingleValued="false">
              <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              <tableName>records</tableName>
              <columnName>department</columnName>
              <key allowMultiple="false">
                  <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.recordId" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                  <columnName>recordid</columnName>
              </key>
          </mapping>
          <mapping isSingleValued="false">
              <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              <tableName>departments</tableName>
              <columnName>department</columnName>
              <key allowMultiple="false">
                  <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.employeeId" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                  <columnName>username</columnName>
              </key>
          </mapping>
          <mapping isSingleValued="false">
              <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.role" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              <tableName>roles</tableName>
              <columnName>role</columnName>
              <key allowMultiple="false">
                  <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.employeeId" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                  <columnName>username</columnName>
              </key>
          </mapping>
          <mapping isSingleValued="false">
              <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.subordinate" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              <tableName>subordinates</tableName>
              <columnName>subordinate</columnName>
              <key allowMultiple="false">
                  <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.employeeId" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                  <columnName>manager</columnName>
              </key>
          </mapping>
          <mapping isSingleValued="false">
              <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.owner" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              <tableName>records</tableName>
              <columnName>owner</columnName>
              <key allowMultiple="false">
                  <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.recordId" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                  <columnName>recordid</columnName>
              </key>
          </mapping>
          <mapping isSingleValued="false">
              <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.status" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              <tableName>records</tableName>
              <columnName>status</columnName>
              <key allowMultiple="false">
                  <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.recordId" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                  <columnName>recordid</columnName>
              </key>
          </mapping>
      </configuration>
attributeCache:
  user.role:
    timeToLive: 30 seconds
    maxItems: 1000
decisionParameters:
  partialEvaluationThreshold: 3
