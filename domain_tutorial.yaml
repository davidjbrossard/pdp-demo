identity: tutorial
metadata:
  status: under development
  createdBy: Bob
  approvedBy: Alice
policy:
  mainPolicyId: http://axiomatics.com/alfa/identifier/demo.allowAll
  xacmlSpecifications:
  - <?xml version="1.0" encoding="UTF-8"?><!--This was generated by the ALFA Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification to this file will be lost upon recompilation of the source ALFA file--><xacml3:Policy xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="http://axiomatics.com/alfa/identifier/demo.allowAll" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target/><xacml3:Rule Effect="Deny" RuleId="demo.allowAll.allow"><xacml3:Description/><xacml3:Target/></xacml3:Rule></xacml3:Policy>
attributes:
  action.actionId:
    xacmlId: action.actionId
    category: Action
    datatype: string
  object.objectType:
    xacmlId: object.objectType
    category: Resource
    datatype: string
  record.department:
    xacmlId: record.department
    category: Resource
    datatype: string
  record.recordId:
    xacmlId: record.recordId
    category: Resource
    datatype: string
  record.owner:
    xacmlId: record.owner
    category: Resource
    datatype: string
  record.status:
    xacmlId: record.status
    category: Resource
    datatype: string
  user.employeeId:
    xacmlId: user.employeeId
    category: AccessSubject
    datatype: string
  user.subordinate:
    xacmlId: user.subordinate
    category: AccessSubject
    datatype: string
  user.role:
    xacmlId: user.role
    category: AccessSubject
    datatype: string
  user.department:
    xacmlId: user.department
    category: AccessSubject
    datatype: string
attributeConnectors:
  Github:
    className: com.axiomatics.attributeconnector.http.ConnectorModule
    provides:
    - recipient.internal.idp_data
    configurationString: "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<configuration\
      \ xmlns=\"http://www.axiomatics.com/http.config\" identifier=\"aadRecipientPayload\"\
      >\n    <connection>\n\t\t<url><![CDATA[https://graph.microsoft.us/v1.0/users/?$filter=proxyAddresses/any(p:p\
      \ eq ‘smtp:{0}’)&$select=employeeid,extension_2525e567f2b741c3aa989715bdcdf415_geECindicator]]></url>\n\
      \t\t<authentication authenticationMode=\"OAuth2\">\n\t\t\t<tokenUrl>https://login.microsoftonline.com/${AZURE_AD_TENANT_ID:-000000}/oauth2/v2.0/token</tokenUrl>\n\
      \t\t\t<clientId>${AZURE_AD_CLIENT_ID:-111111111}</clientId>\n\t\t\t<clientSecret>${AZURE_AD_CLIENT_SECRET:-2222222}</clientSecret>\n\
      \t\t\t<scope>https://graph.microsoft.com/.default</scope>\n\t\t</authentication>\n\
      \t\t<connectionKey>\n\t\t\t<xacmlAttribute Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:recipient-subject\"\
      \ AttributeId=\"recipient.email\" DataType=\"http://www.w3.org/2001/XMLSchema#string\"\
      />\n\t\t</connectionKey>\n        <method>GET</method>\n\t\t<ignoredHttpCode>404</ignoredHttpCode>\n\
      \    </connection>\n    <mapping>\n\t\t<xacmlAttribute Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:recipient-subject\"\
      \ AttributeId=\"recipient.internal.idp_data\" DataType=\"http://www.w3.org/2001/XMLSchema#string\"\
      \ Issuer=\"\"/>\n\t\t<contentType>application/json</contentType>\n\t\t<template\
      \ classpath=\"true\" payload=\"false\">/request.template.json</template>\n \
      \   </mapping>\n</configuration>"
  payloadParser:
    className: com.axiomatics.attributeconnector.parser.json.ConnectorModule
    provides:
    - recipient.internal.userId
    - recipient.internal.ecIndicator
    configurationString: "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<configuration\
      \ xmlns=\"http://www.axiomatics.com/attributeconnector/parser/json/configuration\"\
      \n    identifier=\"recipient.idp_data-extractor\">\n    <source>\n        <xacmlAttribute\
      \ AttributeId=\"recipient.internal.idp_data\"\n                Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:recipient-subject\"\
      \n                DataType=\"http://www.w3.org/2001/XMLSchema#string\" />\n\
      \    </source>\n    <mapping>\n        <xacmlAttribute AttributeId=\"recipient.internal.ecIndicator\"\
      \n                Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:recipient-subject\"\
      \n                DataType=\"http://www.w3.org/2001/XMLSchema#string\" />\n\
      \        <jsonPath>$.value[*].extension_2525e567f2b741c3aa989715bdcdf415_geECindicator</jsonPath>\n\
      \    </mapping>\n    <mapping> \n        <xacmlAttribute AttributeId=\"recipient.internal.userId\"\
      \ \n            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:recipient-subject\"\
      \n            DataType=\"http://www.w3.org/2001/XMLSchema#string\" />\n    \
      \    <jsonPath>$.value[*].employeeId</jsonPath>\n    </mapping>\n</configuration>"