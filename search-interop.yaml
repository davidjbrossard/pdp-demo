identity: search-demo
metadata:
  status: draft
  createdBy: David
  approvedBy: Mark
policy:
  mainPolicyId: http://axiomatics.com/alfa/identifier/authzen.search.record
  xacmlSpecifications:
  - <?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA
    Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification
    to this file will be lost upon recompilation of the source ALFA file--><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable"
    PolicySetId="http://axiomatics.com/alfa/identifier/authzen.interop.main" Version="1.0"
    xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><xacml3:Description>The
    Main Policyset</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit"
    PolicySetId="http://axiomatics.com/alfa/identifier/authzen.interop.main.todo"
    Version="1.0"><xacml3:Description>Policy for ToDo's</xacml3:Description><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">todo</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="type" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/authzen.interop.main.todo.read"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-unless-deny"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">can_read_todos</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="name" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Policy><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/authzen.interop.main.todo.create"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">can_create_todo</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="name" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="authzen.interop.main.todo.create.evilGeniusAllowed"><xacml3:Description/><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">admin</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">editor</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Rule></xacml3:Policy><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/authzen.interop.main.todo.update"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">can_update_todo</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="name" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="authzen.interop.main.todo.update.evilGeniusAllowed"><xacml3:Description/><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">evil_genius</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Rule><xacml3:Rule
    Effect="Permit" RuleId="authzen.interop.main.todo.update.editorAndOwnerAllowed"><xacml3:Description/><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">editor</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Condition><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"/><xacml3:AttributeDesignator
    AttributeId="ownerID" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator
    AttributeId="user.email" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/authzen.interop.main.todo.delete"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">can_delete_todo</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="name" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="authzen.interop.main.todo.delete.evilGeniusAllowed"><xacml3:Description/><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">admin</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Rule><xacml3:Rule
    Effect="Permit" RuleId="authzen.interop.main.todo.delete.editorAndOwnerAllowed"><xacml3:Description/><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">editor</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="user.role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Condition><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="ownerID" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeDesignator
    AttributeId="user.email" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy></xacml3:PolicySet><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:deny-unless-permit"
    PolicySetId="http://axiomatics.com/alfa/identifier/authzen.interop.main.users"
    Version="1.0"><xacml3:Description/><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">user</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="type" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/authzen.interop.main.users.read"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-unless-deny"
    Version="1.0"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">can_read_user</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="name" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Policy></xacml3:PolicySet></xacml3:PolicySet>
  - "<?xml version=\"1.0\" encoding=\"UTF-8\"?><!--This file was generated by the\
    \ ALFA Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any\
    \ modification to this file will be lost upon recompilation of the source ALFA\
    \ file--><xacml3:PolicySet PolicyCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable\"\
    \ PolicySetId=\"http://axiomatics.com/alfa/identifier/authzen.search.record\"\
    \ Version=\"1.0\" xmlns:xacml3=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\"\
    ><xacml3:Description/><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match\
    \ MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><xacml3:AttributeValue\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\">record</xacml3:AttributeValue><xacml3:AttributeDesignator\
    \ AttributeId=\"object.objectType\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Policy\
    \ PolicyId=\"http://axiomatics.com/alfa/identifier/authzen.search.record.viewRecord\"\
    \ RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable\"\
    \ Version=\"1.0\"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match\
    \ MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><xacml3:AttributeValue\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\">view</xacml3:AttributeValue><xacml3:AttributeDesignator\
    \ AttributeId=\"action.name\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect=\"\
    Permit\" RuleId=\"authzen.search.record.viewRecord.ownersAndDepartments\"><xacml3:Description>a\
    \ user can view any record they own&#13;\r\na user can view any record in their\
    \ department</xacml3:Description><xacml3:Target/><xacml3:Condition><xacml3:Apply\
    \ FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:or\"><xacml3:Apply FunctionId=\"\
    urn:oasis:names:tc:xacml:3.0:function:any-of-any\"><xacml3:Function FunctionId=\"\
    urn:oasis:names:tc:xacml:1.0:function:string-equal\"/><xacml3:AttributeDesignator\
    \ AttributeId=\"record.owner\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /><xacml3:AttributeDesignator AttributeId=\"user.name\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Apply><xacml3:Apply FunctionId=\"urn:oasis:names:tc:xacml:3.0:function:any-of-any\"\
    ><xacml3:Function FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\
    /><xacml3:AttributeDesignator AttributeId=\"user.department\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /><xacml3:AttributeDesignator AttributeId=\"record.department\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Apply></xacml3:Apply></xacml3:Condition></xacml3:Rule><xacml3:Rule\
    \ Effect=\"Permit\" RuleId=\"authzen.search.record.viewRecord.managers\"><xacml3:Description>a\
    \ manager can view any record</xacml3:Description><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match\
    \ MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><xacml3:AttributeValue\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\">manager</xacml3:AttributeValue><xacml3:AttributeDesignator\
    \ AttributeId=\"user.role\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target></xacml3:Rule></xacml3:Policy><xacml3:Policy\
    \ PolicyId=\"http://axiomatics.com/alfa/identifier/authzen.search.record.editRecord\"\
    \ RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable\"\
    \ Version=\"1.0\"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match\
    \ MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><xacml3:AttributeValue\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\">edit</xacml3:AttributeValue><xacml3:AttributeDesignator\
    \ AttributeId=\"action.name\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect=\"\
    Permit\" RuleId=\"authzen.search.record.editRecord.owners\"><xacml3:Description>a\
    \ user can edit any record they own</xacml3:Description><xacml3:Target/><xacml3:Condition><xacml3:Apply\
    \ FunctionId=\"urn:oasis:names:tc:xacml:3.0:function:any-of-any\"><xacml3:Function\
    \ FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"/><xacml3:AttributeDesignator\
    \ AttributeId=\"record.owner\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /><xacml3:AttributeDesignator AttributeId=\"user.name\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Apply></xacml3:Condition></xacml3:Rule><xacml3:Rule Effect=\"Permit\"\
    \ RuleId=\"authzen.search.record.editRecord.managers\"><xacml3:Description>a manager\
    \ can edit any record in their department</xacml3:Description><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match\
    \ MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><xacml3:AttributeValue\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\">manager</xacml3:AttributeValue><xacml3:AttributeDesignator\
    \ AttributeId=\"user.role\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Condition><xacml3:Apply\
    \ FunctionId=\"urn:oasis:names:tc:xacml:3.0:function:any-of-any\"><xacml3:Function\
    \ FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"/><xacml3:AttributeDesignator\
    \ AttributeId=\"user.department\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /><xacml3:AttributeDesignator AttributeId=\"record.department\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy><xacml3:Policy\
    \ PolicyId=\"http://axiomatics.com/alfa/identifier/authzen.search.record.deleteRecord\"\
    \ RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable\"\
    \ Version=\"1.0\"><xacml3:Description/><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match\
    \ MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><xacml3:AttributeValue\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\">delete</xacml3:AttributeValue><xacml3:AttributeDesignator\
    \ AttributeId=\"action.name\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule Effect=\"\
    Permit\" RuleId=\"authzen.search.record.deleteRecord/authzen.search.record.editRecord.owners\"\
    ><xacml3:Description>a user can edit any record they own</xacml3:Description><xacml3:Target/><xacml3:Condition><xacml3:Apply\
    \ FunctionId=\"urn:oasis:names:tc:xacml:3.0:function:any-of-any\"><xacml3:Function\
    \ FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"/><xacml3:AttributeDesignator\
    \ AttributeId=\"record.owner\" Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /><xacml3:AttributeDesignator AttributeId=\"user.name\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\"\
    \ DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"\
    /></xacml3:Apply></xacml3:Condition></xacml3:Rule></xacml3:Policy></xacml3:PolicySet>"
attributes:
  action.name:
    xacmlId: action.name
    category: Action
    datatype: string
  object.objectType:
    xacmlId: object.objectType
    category: Resource
    datatype: string
  record.recordId:
    xacmlId: record.recordId
    category: Resource
    datatype: string
  record.owner:
    xacmlId: record.owner
    category: Resource
    datatype: string
  record.department:
    xacmlId: record.department
    category: Resource
    datatype: string
  user.name:
    xacmlId: user.name
    category: AccessSubject
    datatype: string
  user.role:
    xacmlId: user.role
    category: AccessSubject
    datatype: string
  user.department:
    xacmlId: user.department
    category: AccessSubject
    datatype: string
attributeConnectors:
  search_demo_records:
    className: com.axiomatics.attributeconnector.parser.json.ConnectorModule
    provides:
    - record.department
    - record.owner
    configurationString: |-
      <?xml version="1.0" encoding="UTF-8"?>
      <configuration xmlns="http://www.axiomatics.com/attributeconnector/parser/json/configuration" identifier="authzen_search_records_data">
        <source>
          <json>
        [{
          "id": 101,
          "title": "Hamlet",
          "department": "Legal",
          "owner": "alice"
        },
        {
          "id": 102,
          "title": "Othello",
          "department": "Legal",
          "owner": "bob"
        },
        {
          "id": 103,
          "title": "Macbeth",
          "department": "Legal",
          "owner": "carol"
        },
        {
          "id": 104,
          "title": "King Lear",
          "department": "Accounting",
          "owner": "dan"
        },
        {
          "id": 105,
          "title": "Romeo and Juliet",
          "department": "Legal",
          "owner": "erin"
        },
        {
          "id": 106,
          "title": "A Midsummer Night's Dream",
          "department": "Accounting",
          "owner": "felix"
        },
        {
          "id": 107,
          "title": "The Tempest",
          "department": "Sales",
          "owner": "alice"
        },
        {
          "id": 108,
          "title": "Twelfth Night",
          "department": "Legal",
          "owner": "bob"
        },
        {
          "id": 109,
          "title": "Julius Caesar",
          "department": "Accounting",
          "owner": "carol"
        },
        {
          "id": 110,
          "title": "As You Like It",
          "department": "Sales",
          "owner": "dan"
        },
        {
          "id": 111,
          "title": "Much Ado About Nothing",
          "department": "Accounting",
          "owner": "erin"
        },
        {
          "id": 112,
          "title": "The Merchant of Venice",
          "department": "Legal",
          "owner": "felix"
        },
        {
          "id": 113,
          "title": "Henry V",
          "department": "Sales",
          "owner": "alice"
        },
        {
          "id": 114,
          "title": "Richard III",
          "department": "Accounting",
          "owner": "bob"
        },
        {
          "id": 115,
          "title": "Coriolanus",
          "department": "Finance",
          "owner": "carol"
        },
        {
          "id": 116,
          "title": "Taming of the Shrew",
          "department": "Legal",
          "owner": "dan"
        },
        {
          "id": 117,
          "title": "Antony and Cleopatra",
          "department": "Legal",
          "owner": "erin"
        },
        {
          "id": 118,
          "title": "Measure for Measure",
          "department": "Accounting",
          "owner": "felix"
        },
        {
          "id": 119,
          "title": "The Winter's Tale",
          "department": "Legal",
          "owner": "alice"
        },
        {
          "id": 120,
          "title": "All's Well That Ends Well",
          "department": "Accounting",
          "owner": "bob"
        }]
          </json>
        </source>
        <mapping>
          <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
          <jsonPath>$[?(@.id == '##1##')].department</jsonPath>
          <key>
            <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.recordId" DataType="http://www.w3.org/2001/XMLSchema#string"/>
          </key>
        </mapping>
        <mapping>
          <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.owner" DataType="http://www.w3.org/2001/XMLSchema#string"/>
          <jsonPath>$[?(@.id == '##1##')].owner</jsonPath>
          <key>
            <xacmlAttribute Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="record.recordId" DataType="http://www.w3.org/2001/XMLSchema#string"/>
          </key>
        </mapping>

      </configuration>
  search_demo_users:
    className: com.axiomatics.attributeconnector.parser.json.ConnectorModule
    provides:
    - user.role
    - user.department
    configurationString: |-
      <?xml version="1.0" encoding="UTF-8"?>
      <configuration xmlns="http://www.axiomatics.com/attributeconnector/parser/json/configuration" identifier="authzen_search_user_data">
        <source>
          <json>
        [{
          "id": "alice",
          "role": "manager",
          "department": "Sales"
        },
        {
          "id": "bob",
          "role": "employee",
          "department": "Legal"
        },
        {
          "id": "carol",
          "role": "contractor",
          "department": "Legal"
        },
        {
          "id": "dan",
          "role": "manager",
          "department": "Finance"
        },
        {
          "id": "erin",
          "role": "employee",
          "department": "Finance"
        },
        {
          "id": "felix",
          "role": "contractor",
          "department": "Accounting"
        }]
          </json>
        </source>
        <mapping>
          <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.role" DataType="http://www.w3.org/2001/XMLSchema#string"/>
          <jsonPath>$[?(@.id == '##1##')].role</jsonPath>
          <key>
            <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.name" DataType="http://www.w3.org/2001/XMLSchema#string"/>
          </key>
        </mapping>
        <mapping>
          <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
          <jsonPath>$[?(@.id == '##1##')].department</jsonPath>
          <key>
            <xacmlAttribute Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="user.name" DataType="http://www.w3.org/2001/XMLSchema#string"/>
          </key>
        </mapping>

      </configuration>
decisionParameters:
  partialEvaluationThreshold: 3
